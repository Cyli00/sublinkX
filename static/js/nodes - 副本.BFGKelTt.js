import{d as e,r as a,o as l,B as t,c as o,e as s,$ as u,w as i,m as r,a4 as n,a5 as m,a7 as p,l as d,a6 as c,g as v,t as f,aB as _,a8 as g,aK as y}from"./index.BQLDJCDE.js";import{E as j}from"./el-card.CTX5lC-5.js";import{E as k}from"./el-pagination.C2oQGxLD.js";import{E as w}from"./el-tag.X3ElC6JM.js";import"./el-select.D09r31B5.js";import"./el-scrollbar.PI2VZJ2b.js";import"./el-popper.CpH5HJMu.js";import{E as C,a as h}from"./el-table-column.Bm4IobD1.js";import"./el-tooltip.l0sNRNKZ.js";import{E as x}from"./el-dialog.4Gr8TKyA.js";/* empty css                       */import{E as b,a as V,g as z,A as D,U as E,D as I}from"./node.CjAEeY-e.js";import{_ as B}from"./_plugin-vue_export-helper.BCo6x5W8.js";import"./isEqual.DADUiilY.js";import"./_initCloneObject.C1ttGGcT.js";import"./strings.Dv2nQ1TS.js";import"./castArray.CrTKd7It.js";import"./debounce.7DwFOk0p.js";import"./index.DQmdMWe2.js";import"./index.DNViV2ks.js";import"./index.CclK_oo-.js";import"./use-dialog.BsWeMcUI.js";import"./refs.Cs1Biyat.js";const K={class:"dialog-footer"},L=B(e({__name:"nodes - 副本",setup(e){const B=a([]),L=a(""),T=a(""),U=a(""),N=a(""),O=a(!1),R=a(),S=a(""),A=a("1");async function J(){const{data:e}=await z();B.value=e}l((async()=>{J()}));const $=()=>{S.value="添加节点",L.value="",U.value="",A.value="1",O.value=!0},q=async()=>{let e=L.value.split(/[\r\n,]/);if(e=e.map((e=>e.trim())).filter((e=>""!==e)),"添加节点"==S.value){if("1"===A.value){if(""===U.value.trim())return void _.error("备注不能为空");e&&(L.value=e.join(","),await D({link:L.value.trim(),name:U.value.trim()}))}else for(let a=0;a<e.length;a++)await D({link:e[a],name:""});_.success("添加成功")}else await E({oldname:N.value.trim(),oldlink:T.value.trim(),link:L.value.trim(),name:U.value.trim()}),_.success("更新成功");J(),L.value="",U.value="",O.value=!1},F=a([]),G=e=>{F.value=e},P=()=>{0!==F.value.length&&y.confirm("你是否要删除选中这些 ?","提示",{confirmButtonText:"OK",cancelButtonText:"Cancel",type:"warning"}).then((()=>{for(let e=0;e<F.value.length;e++)I({id:F.value[e].ID}),B.value=B.value.filter((a=>a.ID!==F.value[e].ID));_({type:"success",message:"删除成功"})}))},W=a(1),H=a(10),M=e=>{H.value=e},Q=e=>{W.value=e},X=t((()=>{const e=(W.value-1)*H.value,a=e+H.value;return B.value.slice(e,a)})),Y=e=>{(e=>{const a=document.createElement("textarea");a.value=e,document.body.appendChild(a),a.select();try{const e=document.execCommand("copy");_({type:e?"success":"warning",message:e?"复制成功！":"复制失败！"})}catch(l){_({type:"warning",message:"复制失败！"})}finally{document.body.removeChild(a)}})(e.Link)};return(e,a)=>{const l=m,t=V,z=b,D=c,E=x,F=h,Z=w,ee=C,ae=k,le=j;return s(),o("div",null,[u(E,{modelValue:O.value,"onUpdate:modelValue":a[4]||(a[4]=e=>O.value=e),title:S.value,width:"80%"},{footer:i((()=>[d("div",K,[u(D,{onClick:a[3]||(a[3]=e=>O.value=!1)},{default:i((()=>a[9]||(a[9]=[p("关闭")]))),_:1,__:[9]}),u(D,{type:"primary",onClick:q},{default:i((()=>a[10]||(a[10]=[p("确定")]))),_:1,__:[10]})])])),default:i((()=>[u(l,{modelValue:L.value,"onUpdate:modelValue":a[0]||(a[0]=e=>L.value=e),placeholder:"请输入节点多行使用回车或逗号分开,支持base64格式的url订阅",type:"textarea",style:{"margin-bottom":"10px"},autosize:{minRows:2,maxRows:10}},null,8,["modelValue"]),"添加节点"==S.value?(s(),r(z,{key:0,modelValue:A.value,"onUpdate:modelValue":a[1]||(a[1]=e=>A.value=e),class:"ml-4"},{default:i((()=>[u(t,{value:"1",size:"large"},{default:i((()=>a[7]||(a[7]=[p("合并")]))),_:1,__:[7]}),u(t,{value:"2",size:"large"},{default:i((()=>a[8]||(a[8]=[p("分开")]))),_:1,__:[8]})])),_:1},8,["modelValue"])):n("",!0),"2"!=A.value?(s(),r(l,{key:1,modelValue:U.value,"onUpdate:modelValue":a[2]||(a[2]=e=>U.value=e),placeholder:"请输入备注"},null,8,["modelValue"])):n("",!0)])),_:1},8,["modelValue","title"]),u(le,null,{default:i((()=>[u(D,{type:"primary",onClick:$},{default:i((()=>a[11]||(a[11]=[p("添加节点")]))),_:1,__:[11]}),a[18]||(a[18]=d("div",{style:{"margin-bottom":"10px"}},null,-1)),u(ee,{ref_key:"table",ref:R,data:v(X),style:{width:"100%"},onSelectionChange:G},{default:i((()=>[u(F,{type:"selection",fixed:"",prop:"ID",label:"id"}),u(F,{prop:"Name",label:"备注"},{default:i((e=>[u(Z,{type:"success"},{default:i((()=>[p(f(e.row.Name),1)])),_:2},1024)])),_:1}),u(F,{prop:"Link",label:"节点",sortable:"","show-overflow-tooltip":!0}),u(F,{prop:"CreateDate",label:"创建时间",sortable:""}),u(F,{fixed:"right",label:"操作",width:"120"},{default:i((e=>[u(D,{link:"",type:"primary",size:"small",onClick:a=>Y(e.row)},{default:i((()=>a[12]||(a[12]=[p("复制")]))),_:2,__:[12]},1032,["onClick"]),u(D,{link:"",type:"primary",size:"small",onClick:a=>(e=>{A.value="1";for(let a=0;a<B.value.length;a++)B.value[a].ID===e.ID&&(S.value="编辑节点",U.value=B.value[a].Name,N.value=U.value,L.value=B.value[a].Link,T.value=L.value,O.value=!0)})(e.row)},{default:i((()=>a[13]||(a[13]=[p("编辑")]))),_:2,__:[13]},1032,["onClick"]),u(D,{link:"",type:"primary",size:"small",onClick:a=>{return l=e.row,void y.confirm(`你是否要删除 ${l.Name} ?`,"提示",{confirmButtonText:"OK",cancelButtonText:"Cancel",type:"warning"}).then((async()=>{await I({id:l.ID}),_({type:"success",message:"删除成功"}),J()}));var l}},{default:i((()=>a[14]||(a[14]=[p("删除")]))),_:2,__:[14]},1032,["onClick"])])),_:1})])),_:1},8,["data"]),a[19]||(a[19]=d("div",{style:{"margin-top":"20px"}},null,-1)),u(D,{type:"info",onClick:a[5]||(a[5]=e=>{g((()=>{B.value.forEach((e=>{R.value.toggleRowSelection(e,!0)}))}))})},{default:i((()=>a[15]||(a[15]=[p("全选")]))),_:1,__:[15]}),u(D,{type:"warning",onClick:a[6]||(a[6]=e=>{R.value.clearSelection()})},{default:i((()=>a[16]||(a[16]=[p("取消选择")]))),_:1,__:[16]}),u(D,{type:"danger",onClick:P},{default:i((()=>a[17]||(a[17]=[p("批量删除")]))),_:1,__:[17]}),a[20]||(a[20]=d("div",{style:{"margin-top":"20px"}},null,-1)),u(ae,{onSizeChange:M,onCurrentChange:Q,"current-page":W.value,"page-size":H.value,layout:"total, sizes, prev, pager, next, jumper","page-sizes":[10,20,30,40],total:B.value.length},null,8,["current-page","page-size","total"])])),_:1,__:[18,19,20]})])}}}),[["__scopeId","data-v-dcce509d"]]);export{L as default};
